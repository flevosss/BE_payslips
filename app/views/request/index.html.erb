  <% if current_user.employee&.department.blank? %>
    <div class="bg-white rounded-2xl shadow-sm p-8 border border-gray-100">
      <div class="text-center py-8">
        <%= heroicon "exclamation-triangle", variant: :outline, options: { class: "w-16 h-16 text-gray-400 mx-auto mb-4" } %>
        <h3 class="text-lg font-semibold text-gray-900 mb-2">No Department Assigned</h3>
        <p class="text-gray-600">Please contact your employer to complete your profile.</p>
      </div>
    </div>
  <% else %>
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-8">
      
      <!-- Left Column: Request Form -->
      <div class="lg:col-span-4">
        <div class="bg-white rounded-2xl shadow-sm border border-gray-200">
          <div class="flex items-center px-6 py-4 border-b border-gray-100">
            <div class="w-10 h-10  flex items-center justify-center">
              <%= heroicon "calendar-days", variant: :solid, options: { class: "w-5 h-5 text-green-900" } %>
            </div>
            <h2 class="text-xl font-bold text-gray-900">New Request</h2>
          </div>
          
          <%= form_with model: @vacation_request, url: request_path, class: "space-y-5 p-6" do |f| %>
            
            <!-- Leave Type -->
            <div>
              <%= f.label :leave_type, class: "block text-sm font-medium text-gray-700 mb-2" do %>
                Type of Leave
              <% end %>
              <%= f.select :leave_type, 
                  options_for_select([
                    ['Vacation', 'vacation'],
                    ['Sick Leave', 'sick_leave'],
                    ['Personal Leave', 'personal_leave'],
                    ['Unpaid Leave', 'unpaid_leave'],
                    ['Other', 'other']
                  ], @vacation_request.leave_type),
                  {},
                  class: "w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm transition-all",
                  required: true %>
              <% if @vacation_request.errors[:leave_type].any? %>
                <p class="mt-1.5 text-xs text-red-600 font-medium flex items-center">
                  <%= heroicon "exclamation-circle", variant: :mini, options: { class: "w-3.5 h-3.5 mr-1" } %>
                  <%= @vacation_request.errors[:leave_type].first %>
                </p>
              <% end %>
            </div>
            
            <!-- Start Date -->
            <div>
              <%= f.label :start_date, class: "block text-sm font-medium text-gray-700 mb-2" do %>
                Start Date
              <% end %>
              <%= f.date_field :start_date, 
                  min: Date.today,
                  class: "w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm transition-all",
                  required: true %>
              <% if @vacation_request.errors[:start_date].any? %>
                <p class="mt-1.5 text-xs text-red-600 font-medium flex items-center">
                  <%= heroicon "exclamation-circle", variant: :mini, options: { class: "w-3.5 h-3.5 mr-1" } %>
                  <%= @vacation_request.errors[:start_date].first %>
                </p>
              <% end %>
            </div>

            <!-- End Date -->
            <div>
              <%= f.label :end_date, class: "block text-sm font-medium text-gray-700 mb-2" do %>
                End Date
              <% end %>
              <%= f.date_field :end_date, 
                  min: Date.today,
                  class: "w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm transition-all",
                  required: true %>
              <% if @vacation_request.errors[:end_date].any? %>
                <p class="mt-1.5 text-xs text-red-600 font-medium flex items-center">
                  <%= heroicon "exclamation-circle", variant: :mini, options: { class: "w-3.5 h-3.5 mr-1" } %>
                  <%= @vacation_request.errors[:end_date].first %>
                </p>
              <% end %>
            </div>

            <!-- Reason -->
            <div>
              <%= f.label :reason, class: "block text-sm font-medium text-gray-700 mb-2" do %>
                Reason
              <% end %>
              <%= f.text_area :reason, 
                  rows: 4,
                  class: "w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 text-sm resize-none transition-all",
                  required: true %>
              <% if @vacation_request.errors[:reason].any? %>
                <p class="mt-1.5 text-xs text-red-600 font-medium flex items-center">
                  <%= heroicon "exclamation-circle", variant: :mini, options: { class: "w-3.5 h-3.5 mr-1" } %>
                  <%= @vacation_request.errors[:reason].first %>
                </p>
              <% end %>
            </div>

            <!-- Submit Button -->
            <%= f.submit "Submit Request", 
                class: "w-full bg-green-900 text-white py-3 rounded-lg hover:bg-green-800 transition-all font-semibold shadow-md hover:shadow-lg cursor-pointer" %>
          <% end %>
        </div>
      </div>

      <!-- Right Column: Requests History -->
      <div class="lg:col-span-8">
        <%= render 'shared/requests_list', 
            requests: @vacation_requests,
            container_class: "h-[596px]",
            empty_message: "Submit your first leave request to get started!" %>
      </div>

    </div>

  <% end %>
</div>
