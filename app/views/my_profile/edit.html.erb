<% content_for :title, "Edit Profile - RailSlips" %>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="mb-6">
    <%= link_to my_profile_path, class: "inline-flex items-center text-sm text-gray-600 hover:text-gray-900" do %>
      <%= heroicon "arrow-left", variant: :outline, options: { class: "w-4 h-4 mr-2" } %>
      Back to My Profile
    <% end %>
  </div>

  <%= form_with model: @user.employee, url: my_profile_path, method: :patch, local: true do |f| %>
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <%= render 'shared/info_card', title: 'Personal Information', icon: 'user-circle' do %>
        <div class="space-y-4">
          <div>
            <label for="employee_first_name" class="block text-sm font-medium text-gray-500 mb-2">
              First Name
            </label>
            <%= f.text_field :first_name, 
                class: "w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-green-950 focus:bg-white px-3 py-2.5",
                placeholder: "Enter first name" %>
          </div>

          <div>
            <label for="employee_last_name" class="block text-sm font-medium text-gray-500 mb-2">
              Last Name
            </label>
            <%= f.text_field :last_name, 
                class: "w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-green-950 focus:bg-white px-3 py-2.5",
                placeholder: "Enter last name" %>
          </div>

          <div>
            <label for="employee_date_of_birth" class="block text-sm font-medium text-gray-500 mb-2">
              Date of Birth
            </label>
            <%= render RubyUI::Popover.new(options: { trigger: "click" }) do %>
              <%= render RubyUI::PopoverTrigger.new(class: "w-full") do %>
                <%= f.text_field :date_of_birth,
                    value: @user.employee.date_of_birth&.strftime('%Y-%m-%d'),
                    placeholder: "Select date of birth",
                    class: "w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-green-950 focus:bg-white px-3 py-2.5",
                    id: "employee_date_of_birth_input",
                    data: { controller: "ruby-ui--calendar-input" } %>
              <% end %>
              <%= render RubyUI::PopoverContent.new do %>
                <%= render RubyUI::Calendar.new(
                  selected_date: @user.employee.date_of_birth || Date.current,
                  input_id: "#employee_date_of_birth_input"
                ) %>
              <% end %>
            <% end %>
          </div>

          <div>
            <label for="employee_bsn" class="block text-sm font-medium text-gray-500 mb-2">
              BSN
            </label>
            <%= f.text_field :bsn, 
                class: "w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-green-950 focus:bg-white px-3 py-2.5",
                placeholder: "9-digit BSN",
                maxlength: 9 %>
          </div>
        </div>
      <% end %>

      <%= render 'shared/info_card', title: 'Contact Information', icon: 'map-pin' do %>
        <div class="space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-500 mb-2">
              Email
            </label>
            <p class="text-sm text-gray-900"><%= @user.email %></p>
          </div>

          <div>
            <label for="employee_address" class="block text-sm font-medium text-gray-500 mb-2">
              Address
            </label>
            <%= f.text_field :address, 
                class: "w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-green-950 focus:bg-white px-3 py-2.5",
                placeholder: "Enter address" %>
          </div>

          <div>
            <label for="employee_postal_code" class="block text-sm font-medium text-gray-500 mb-2">
              Postal Code
            </label>
            <%= f.text_field :postal_code, 
                class: "w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-green-950 focus:bg-white px-3 py-2.5",
                placeholder: "Enter postal code" %>
          </div>
        </div>
      <% end %>

      <%= render 'shared/info_card', title: 'Bank Account Information', icon: 'credit-card' do %>
        <%= f.fields_for :account_info do |account_fields| %>
          <div class="space-y-4">
            <div>
              <label for="account_info_account_name" class="block text-sm font-medium text-gray-500 mb-2">
                Account Name
              </label>
              <%= account_fields.text_field :account_name, 
                  class: "w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-green-950 focus:bg-white px-3 py-2.5",
                  placeholder: "Enter account holder name" %>
            </div>

            <div>
              <label for="account_info_account_number" class="block text-sm font-medium text-gray-500 mb-2">
                Account Number (IBAN)
              </label>
              <%= account_fields.text_field :account_number, 
                  class: "w-full rounded-md border-gray-300 bg-gray-50 shadow-sm focus:border-green-950 focus:bg-white font-mono px-3 py-2.5",
                  placeholder: "Enter IBAN",
                  maxlength: 34 %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>

    <div class="flex gap-3 mt-6">
      <%= f.submit "Save Changes", 
          class: "bg-green-900 text-white px-6 py-2 rounded-md hover:bg-green-800 transition-colors font-medium" %>
    </div>
  <% end %>
</div>

